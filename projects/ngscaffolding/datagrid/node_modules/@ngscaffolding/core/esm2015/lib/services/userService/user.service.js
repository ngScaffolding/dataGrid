import { Injectable } from '@angular/core';
import { AppSettings } from '@ngscaffolding/models';
import { Observable } from 'rxjs';
import { timeout } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "../appSettings/appSettings.service";
import * as i3 from "../userAuthentication/userAuthentication.query";
import * as i4 from "../logging/logging.service";
import * as i5 from "../rolesService/roles.service";
export class UserService {
    constructor(http, appSettingsService, authQuery, log, rolesService) {
        this.http = http;
        this.appSettingsService = appSettingsService;
        this.authQuery = authQuery;
        this.log = log;
        this.rolesService = rolesService;
        this.className = 'core.UserService';
    }
    getUsers() {
        return new Observable(observer => {
            this.http.get(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users`);
        }).pipe(timeout(30000));
    }
    createUser(user) {
        return new Observable(observer => {
            this.http.post(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users`, user);
        }).pipe(timeout(30000));
    }
    deleteUser(userId) {
        return new Observable(observer => {
            this.http.delete(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users/${userId}`);
        }).pipe(timeout(30000));
    }
    changePassword(changePasswordModel) {
        return new Observable(observer => {
            this.http.post(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users/changePassword`, changePasswordModel)
                .pipe(timeout(30000))
                .subscribe(response => {
                observer.next(null);
                observer.complete();
            }, err => {
                observer.error(err);
            });
        });
    }
    setPassword(changePasswordModel) {
        return new Observable(observer => {
            this.http.post(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users/setPassword`, changePasswordModel)
                .pipe(timeout(30000))
                .subscribe(response => {
                observer.next(null);
                observer.complete();
            }, err => {
                observer.error(err);
            });
        });
    }
    resetPassword(userId) {
        return new Observable(observer => {
            this.http.get(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users/resetPassword/${userId}`);
        }).pipe(timeout(30000));
    }
    getUser(userId) {
        return new Observable(observer => {
            this.http.get(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users/${userId}`);
        }).pipe(timeout(30000));
    }
    saveUser(user) {
        return new Observable(observer => {
            this.http.post(`${this.appSettingsService.getValue(AppSettings.apiAuth)}/api/v1/users/`, user);
        }).pipe(timeout(30000));
    }
}
UserService.ɵfac = function UserService_Factory(t) { return new (t || UserService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.AppSettingsService), i0.ɵɵinject(i3.UserAuthenticationQuery), i0.ɵɵinject(i4.LoggingService), i0.ɵɵinject(i5.RolesService)); };
UserService.ɵprov = i0.ɵɵdefineInjectable({ token: UserService, factory: UserService.ɵfac, providedIn: 'root' });
/*@__PURE__*/ (function () { i0.ɵsetClassMetadata(UserService, [{
        type: Injectable,
        args: [{
                providedIn: 'root',
            }]
    }], function () { return [{ type: i1.HttpClient }, { type: i2.AppSettingsService }, { type: i3.UserAuthenticationQuery }, { type: i4.LoggingService }, { type: i5.RolesService }]; }, null); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uL3Byb2plY3RzL25nc2NhZmZvbGRpbmcvY29yZS9zcmMvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvdXNlclNlcnZpY2UvdXNlci5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFLM0MsT0FBTyxFQUFjLFdBQVcsRUFBdUIsTUFBTSx1QkFBdUIsQ0FBQztBQUNyRixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2xDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7OztBQVF6QyxNQUFNLE9BQU8sV0FBVztJQUt0QixZQUNVLElBQWdCLEVBQ2hCLGtCQUFzQyxFQUN0QyxTQUFrQyxFQUNsQyxHQUFtQixFQUNwQixZQUEwQjtRQUp6QixTQUFJLEdBQUosSUFBSSxDQUFZO1FBQ2hCLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7UUFDdEMsY0FBUyxHQUFULFNBQVMsQ0FBeUI7UUFDbEMsUUFBRyxHQUFILEdBQUcsQ0FBZ0I7UUFDcEIsaUJBQVksR0FBWixZQUFZLENBQWM7UUFUM0IsY0FBUyxHQUFHLGtCQUFrQixDQUFDO0lBVXBDLENBQUM7SUFFSixRQUFRO1FBQ04sT0FBTyxJQUFJLFVBQVUsQ0FBZSxRQUFRLENBQUMsRUFBRTtZQUM3QyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUN6RixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUNELFVBQVUsQ0FBQyxJQUFTO1FBQ2xCLE9BQU8sSUFBSSxVQUFVLENBQWEsUUFBUSxDQUFDLEVBQUU7WUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2hHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBQ0QsVUFBVSxDQUFDLE1BQVc7UUFDcEIsT0FBTyxJQUFJLFVBQVUsQ0FBTyxRQUFRLENBQUMsRUFBRTtZQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN0RyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUNELGNBQWMsQ0FBQyxtQkFBd0M7UUFDckQsT0FBTyxJQUFJLFVBQVUsQ0FBTyxRQUFRLENBQUMsRUFBRTtZQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyw4QkFBOEIsRUFBRSxtQkFBbUIsQ0FBQztpQkFDeEgsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDcEIsU0FBUyxDQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUNwQixRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNwQixRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDdEIsQ0FBQyxFQUNELEdBQUcsQ0FBQyxFQUFFO2dCQUNKLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDdEIsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxXQUFXLENBQUMsbUJBQXdDO1FBQ2xELE9BQU8sSUFBSSxVQUFVLENBQU8sUUFBUSxDQUFDLEVBQUU7WUFDckMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsMkJBQTJCLEVBQUUsbUJBQW1CLENBQUM7aUJBQ3JILElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7aUJBQ3BCLFNBQVMsQ0FBQyxRQUFRLENBQUMsRUFBRTtnQkFDcEIsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDcEIsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ3RCLENBQUMsRUFDRCxHQUFHLENBQUMsRUFBRTtnQkFDSixRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3RCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsYUFBYSxDQUFDLE1BQVc7UUFDdkIsT0FBTyxJQUFJLFVBQVUsQ0FBTyxRQUFRLENBQUMsRUFBRTtZQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQywrQkFBK0IsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNqSCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUdNLE9BQU8sQ0FBQyxNQUFjO1FBQzNCLE9BQU8sSUFBSSxVQUFVLENBQWEsUUFBUSxDQUFDLEVBQUU7WUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDbkcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFFTSxRQUFRLENBQUMsSUFBZ0I7UUFDOUIsT0FBTyxJQUFJLFVBQVUsQ0FBYSxRQUFRLENBQUMsRUFBRTtZQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNqRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQzs7c0VBekVVLFdBQVc7bURBQVgsV0FBVyxXQUFYLFdBQVcsbUJBRlYsTUFBTTtrREFFUCxXQUFXO2NBSHZCLFVBQVU7ZUFBQztnQkFDVixVQUFVLEVBQUUsTUFBTTthQUNuQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgVXNlckF1dGhlbnRpY2F0aW9uUXVlcnkgfSBmcm9tICcuLi91c2VyQXV0aGVudGljYXRpb24vdXNlckF1dGhlbnRpY2F0aW9uLnF1ZXJ5JztcclxuaW1wb3J0IHsgTG9nZ2luZ1NlcnZpY2UgfSBmcm9tICcuLi9sb2dnaW5nL2xvZ2dpbmcuc2VydmljZSc7XHJcbmltcG9ydCB7IFJvbGVzU2VydmljZSB9IGZyb20gJy4uL3JvbGVzU2VydmljZS9yb2xlcy5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSVVzZXJNb2RlbCwgQXBwU2V0dGluZ3MsIENoYW5nZVBhc3N3b3JkTW9kZWwgfSBmcm9tICdAbmdzY2FmZm9sZGluZy9tb2RlbHMnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHRpbWVvdXQgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFVzZXJTZXJ2aWNlQmFzZSB9IGZyb20gJy4vdXNlci5zZXJ2aWNlLmJhc2UnO1xyXG5pbXBvcnQgeyBBcHBTZXR0aW5nc1NlcnZpY2UgfSBmcm9tICcuLi9hcHBTZXR0aW5ncy9hcHBTZXR0aW5ncy5zZXJ2aWNlJztcclxuXHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgVXNlclNlcnZpY2UgaW1wbGVtZW50cyBVc2VyU2VydmljZUJhc2UgIHtcclxuICBwcml2YXRlIGNsYXNzTmFtZSA9ICdjb3JlLlVzZXJTZXJ2aWNlJztcclxuXHJcbiAgcHJpdmF0ZSBhcGlIb21lOiBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxyXG4gICAgcHJpdmF0ZSBhcHBTZXR0aW5nc1NlcnZpY2U6IEFwcFNldHRpbmdzU2VydmljZSxcclxuICAgIHByaXZhdGUgYXV0aFF1ZXJ5OiBVc2VyQXV0aGVudGljYXRpb25RdWVyeSxcclxuICAgIHByaXZhdGUgbG9nOiBMb2dnaW5nU2VydmljZSxcclxuICAgIHB1YmxpYyByb2xlc1NlcnZpY2U6IFJvbGVzU2VydmljZVxyXG4gICkge31cclxuXHJcbiAgZ2V0VXNlcnMoKSB7XHJcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8SVVzZXJNb2RlbFtdPihvYnNlcnZlciA9PiB7XHJcbiAgICAgIHRoaXMuaHR0cC5nZXQoYCR7dGhpcy5hcHBTZXR0aW5nc1NlcnZpY2UuZ2V0VmFsdWUoQXBwU2V0dGluZ3MuYXBpQXV0aCl9L2FwaS92MS91c2Vyc2ApO1xyXG4gICAgfSkucGlwZSh0aW1lb3V0KDMwMDAwKSk7XHJcbiAgfVxyXG4gIGNyZWF0ZVVzZXIodXNlcjogYW55KSB7XHJcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8SVVzZXJNb2RlbD4ob2JzZXJ2ZXIgPT4ge1xyXG4gICAgICB0aGlzLmh0dHAucG9zdChgJHt0aGlzLmFwcFNldHRpbmdzU2VydmljZS5nZXRWYWx1ZShBcHBTZXR0aW5ncy5hcGlBdXRoKX0vYXBpL3YxL3VzZXJzYCwgdXNlcik7XHJcbiAgICB9KS5waXBlKHRpbWVvdXQoMzAwMDApKTtcclxuICB9XHJcbiAgZGVsZXRlVXNlcih1c2VySWQ6IGFueSkge1xyXG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPG51bGw+KG9ic2VydmVyID0+IHtcclxuICAgICAgdGhpcy5odHRwLmRlbGV0ZShgJHt0aGlzLmFwcFNldHRpbmdzU2VydmljZS5nZXRWYWx1ZShBcHBTZXR0aW5ncy5hcGlBdXRoKX0vYXBpL3YxL3VzZXJzLyR7dXNlcklkfWApO1xyXG4gICAgfSkucGlwZSh0aW1lb3V0KDMwMDAwKSk7XHJcbiAgfVxyXG4gIGNoYW5nZVBhc3N3b3JkKGNoYW5nZVBhc3N3b3JkTW9kZWw6IENoYW5nZVBhc3N3b3JkTW9kZWwpIHtcclxuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZTxudWxsPihvYnNlcnZlciA9PiB7XHJcbiAgICAgIHRoaXMuaHR0cC5wb3N0KGAke3RoaXMuYXBwU2V0dGluZ3NTZXJ2aWNlLmdldFZhbHVlKEFwcFNldHRpbmdzLmFwaUF1dGgpfS9hcGkvdjEvdXNlcnMvY2hhbmdlUGFzc3dvcmRgLCBjaGFuZ2VQYXNzd29yZE1vZGVsKVxyXG4gICAgICAgIC5waXBlKHRpbWVvdXQoMzAwMDApKVxyXG4gICAgICAgIC5zdWJzY3JpYmUocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgICAgb2JzZXJ2ZXIubmV4dChudWxsKTtcclxuICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlcnIgPT4ge1xyXG4gICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0UGFzc3dvcmQoY2hhbmdlUGFzc3dvcmRNb2RlbDogQ2hhbmdlUGFzc3dvcmRNb2RlbCkge1xyXG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPG51bGw+KG9ic2VydmVyID0+IHtcclxuICAgICAgdGhpcy5odHRwLnBvc3QoYCR7dGhpcy5hcHBTZXR0aW5nc1NlcnZpY2UuZ2V0VmFsdWUoQXBwU2V0dGluZ3MuYXBpQXV0aCl9L2FwaS92MS91c2Vycy9zZXRQYXNzd29yZGAsIGNoYW5nZVBhc3N3b3JkTW9kZWwpXHJcbiAgICAgICAgLnBpcGUodGltZW91dCgzMDAwMCkpXHJcbiAgICAgICAgLnN1YnNjcmliZShyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgICBvYnNlcnZlci5uZXh0KG51bGwpO1xyXG4gICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVyciA9PiB7XHJcbiAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFBhc3N3b3JkKHVzZXJJZDogYW55KSB7XHJcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8bnVsbD4ob2JzZXJ2ZXIgPT4ge1xyXG4gICAgICB0aGlzLmh0dHAuZ2V0KGAke3RoaXMuYXBwU2V0dGluZ3NTZXJ2aWNlLmdldFZhbHVlKEFwcFNldHRpbmdzLmFwaUF1dGgpfS9hcGkvdjEvdXNlcnMvcmVzZXRQYXNzd29yZC8ke3VzZXJJZH1gKTtcclxuICAgIH0pLnBpcGUodGltZW91dCgzMDAwMCkpO1xyXG4gIH1cclxuXHJcblxyXG4gIHB1YmxpYyBnZXRVc2VyKHVzZXJJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxJVXNlck1vZGVsPiB7XHJcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8SVVzZXJNb2RlbD4ob2JzZXJ2ZXIgPT4ge1xyXG4gICAgICB0aGlzLmh0dHAuZ2V0KGAke3RoaXMuYXBwU2V0dGluZ3NTZXJ2aWNlLmdldFZhbHVlKEFwcFNldHRpbmdzLmFwaUF1dGgpfS9hcGkvdjEvdXNlcnMvJHt1c2VySWR9YCk7XHJcbiAgICB9KS5waXBlKHRpbWVvdXQoMzAwMDApKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzYXZlVXNlcih1c2VyOiBJVXNlck1vZGVsKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZTxJVXNlck1vZGVsPihvYnNlcnZlciA9PiB7XHJcbiAgICAgIHRoaXMuaHR0cC5wb3N0KGAke3RoaXMuYXBwU2V0dGluZ3NTZXJ2aWNlLmdldFZhbHVlKEFwcFNldHRpbmdzLmFwaUF1dGgpfS9hcGkvdjEvdXNlcnMvYCwgdXNlcik7XHJcbiAgICB9KS5waXBlKHRpbWVvdXQoMzAwMDApKTtcclxuICB9XHJcbn1cclxuIl19